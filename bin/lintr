#!/usr/bin/env Rscript
files <- commandArgs(trailing = TRUE)

git_status <- git2r::status(staged = FALSE)
if (any(grepl("\\.lintr", git_status))) {
  stop("Unstaged changes to .lintr file", call. = FALSE)
}

out <- lapply(files, function(path) {
  lints <- lintr::lint(path)
  if (length(lints) > 0) {
    stop("File ", path, " is not lint free", call. = FALSE)  
  }
})
